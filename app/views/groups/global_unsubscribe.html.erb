<style>.clickable-student{cursor:pointer;}</style>
<div class='row'>
  <div class='col-sm-2'>Student:</div>
  <div class='col-sm-2'><input type='text' disabled id='student_name'/></div>
  <div class='col-sm-6'><button data-toggle="modal" data-target="#searchStudentModal">Search</button></div>
</div>
<div class='row text-right' id='continue_wrap'>
  <div class='col-sm-12'></div>
</div>
<%= render 'search_student_modal' %>

<% content_for :specific_js do %>
<script type='text/javascript'>
  $(document).ready(function(){
		$("#search-student-form").submit(function(e){
			e.preventDefault();
			var _this = $(this)
			_this.find(':button[type="submit"]').prop('disabled', true); 
			var postData = _this.serializeArray();
			var formURL = _this.attr("action");
			$('#search_person_result tbody').html('');
			$('#search_person_result').slideUp();
			$.ajax(
			{
				url : formURL,
				type: "POST",
				data : postData,
				success:function(data){
					if (data){
						var html_data = null;
            data.map(function(d){
              html_data = html_data + '<tr class="clickable-student"><td><input type="checkbox" class="selected_student" value="'+d.id+'" style="display:none;"/>&nbsp;'+d.id+'</td><td id="first_name">'+d.first_name+'</td><td>'+d.fathers_maiden_name+
							'</td><td>'+d.mothers_maiden_name+'</td></tr>';
						})
						if (html_data==null){
							html_data = '<tr><td colspan="3">No se encontr√≥ persona</td></tr>'
						}
						$('#search_student_result tbody').html(html_data); 
						$('#search_student_result').slideDown(); 
					}
					_this.find(':button[type="submit"]').prop('disabled', false);
					$('.clickable-student').click(function(){
            $('#student_name').val($(this).find('#first_name').text());
            $('#searchStudentModal').find('.close').click();
            $('#continue_wrap div.col-sm-12').append('<br/><button>Continue</button>');
            $('#continue_wrap').after('<hr class="normal"/>');
					})
				}
			});
    });
  })
</script>
<% end %>
